# CVE-2019-15505 Postmortem

## Summary

drivers/media/usb/dvb-usb/technisat-usb2.c in the Linux kernel through 5.2.9 has an out-of-bounds read via crafted USB device traffic (which may be remote via usbip or usbredir).

## Root Causes

Initial code caused out of bounds access such as following:

```c
static int technisat_usb2_get_ir(struct dvb_usb_device *d)
{
	u8 buf[62], *b;
	int ret;
	struct ir_raw_event ev;
// --snip--
	/* decoding */
	b = buf+1;

#if 0
	deb_rc("RC: %d ", ret);
	debug_dump(b, ret, deb_rc);
#endif

	ev.pulse = 0;
	while (1) {
		ev.pulse = !ev.pulse;
		ev.duration = (*b * FIRMWARE_CLOCK_DIVISOR * FIRMWARE_CLOCK_TICK) / 1000;
		ir_raw_event_store(d->rc_dev, &ev);

		b++; // <= Out of bounds access
		if (*b == 0xff) {
			ev.pulse = 0;
			ev.duration = 888888*2;
			ir_raw_event_store(d->rc_dev, &ev);
			break;
		}
	}
```

## Resolution

xxx

## File

drivers/media/usb/dvb-usb/technisat-usb2.c

## Timeline

### 2010-10-31 16:24:19 -0300

https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=739ff04f63ba6498b287021649cb999e639c3c83

Caused by Patrick Boettcher. This is the initial code.

### 2019-07-03 10:52:39 -0400

https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0c4df39e504bf925ab666132ac3c98d6cbbe380b

Fixed by Sean Young.

## Supporting information

* CVE: https://www.cvedetails.com/cve/CVE-2019-15505/
* NVD: https://nvd.nist.gov/vuln/detail/CVE-2019-15505
